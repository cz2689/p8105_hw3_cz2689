HW3
================
Chaoqun Zhou
2022-10-14

``` r
library(tidyverse)
library(readxl)
```

# Problem 2

## Data Wrangling:

``` r
p2 = read_csv(file = "./data/accel_data.csv") %>% 
     janitor::clean_names() %>% 
     pivot_longer(activity_1:activity_1440,
                  names_to = "min_of_the_day",
                  values_to = "activity") %>% 
     mutate(min_of_the_day = str_sub(min_of_the_day, 10),
            day = str_to_lower(day),
            weekend = ifelse(day == "saturday"|day == "saturday", "TRUE", "FALSE"),
            weekend = as.logical(weekend),
            )
```

## Describe the resulting dataset.

This data set is about five weeks of accelerometer data collected on a
63 year-old male with BMI 25. So far, I have import the data into R. And
use `janitor::clean_names()` to clean up variables names. Now, this data
set has 6 variables and 50400 observations. It includes variables:
activity, day, day_id, min_of_the_day, week, weekend. I created a new
logical variable `weekend`. It is true when the `day` variable equals to
Sunday or Saturday, and FALSE when the `day` variable equal to weekdays.

## Create a new table showing total activity for each day

``` r
  p2 %>% 
  group_by(week, day) %>% 
  summarise(activity_perday = sum(activity)) %>% 
  pivot_wider(
    names_from = day,
    values_from = activity_perday) %>% 
    knitr::kable(digits = 1)
```

| week |   friday |   monday | saturday | sunday | thursday |  tuesday | wednesday |
|-----:|---------:|---------:|---------:|-------:|---------:|---------:|----------:|
|    1 | 480542.6 |  78828.1 |   376254 | 631105 | 355923.6 | 307094.2 |    340115 |
|    2 | 568839.0 | 295431.0 |   607175 | 422018 | 474048.0 | 423245.0 |    440962 |
|    3 | 467420.0 | 685910.0 |   382928 | 467052 | 371230.0 | 381507.0 |    468869 |
|    4 | 154049.0 | 409450.0 |     1440 | 260617 | 340291.0 | 319568.0 |    434460 |
|    5 | 620860.0 | 389080.0 |     1440 | 138421 | 549658.0 | 367824.0 |    445366 |

As we can see from the table, there are days where this individual have
a lot of activity and days this individual has much less activity. Also,
there are two days where this individual doesn’t have activity (on
Saturday of week 4 and 5). For every minute of the day, the individual
only have 1 activity per minutes which probably means this individual
doesn’t carry this device with him.
